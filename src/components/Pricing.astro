---
const { site } = Astro.props;
const p = site.pricing ?? {};
const rows = p.rows ?? [];
const basicName = p.plans?.[0]?.name ?? "Basic Care Plan";
const premiumName = p.plans?.[1]?.name ?? "Premium Care + Extended Warranty";
---
<section id="pricing" class="nb-anchor-offset nb-section nb-section-alt">
  <div class="container">
    <div class="text-center mb-4">
      <h2 class="nb-section-title">{p.title}</h2>
      <p class="nb-section-subtitle mx-auto">{p.subtitle}</p>
    </div>
    <div class="row g-3 mb-4">
      <div class="col-md-6"><div class="nb-plan-card"><h3 class="h5 fw-bold">{basicName}</h3><div class="nb-muted">{p.plans?.[0]?.monthly}</div><a class="btn btn-sm btn-outline-primary rounded-pill mt-3" href={site.bookings?.url} target="_blank" rel="noopener">Request more information</a></div></div>
      <div class="col-md-6"><div class="nb-plan-card"><h3 class="h5 fw-bold">{premiumName}</h3><div class="nb-muted">{p.plans?.[1]?.monthly}</div><a class="btn btn-sm btn-outline-primary rounded-pill mt-3" href={site.bookings?.url} target="_blank" rel="noopener">Request more information</a></div></div>
    </div>
    <div class="d-none d-lg-block nb-table-wrap">
      <table class="table nb-table align-middle">
        <thead><tr><th>Feature</th><th>{basicName}</th><th>{premiumName}</th></tr></thead>
        <tbody>{rows.map((r) => (<tr><td><strong>{r.feature}</strong></td><td>{r.basic.startsWith("✔") ? <span class="nb-check">{r.basic}</span> : r.basic}</td><td>{r.premium.startsWith("✔") ? <span class="nb-check">{r.premium}</span> : r.premium}</td></tr>))}</tbody>
      </table>
    </div>
    <div class="d-lg-none nb-pricing-mobile">
      <div class="accordion" id="pricingAccordion">
        {rows.map((r,i)=>(
          <div class="accordion-item">
            <h2 class="accordion-header" id={`h-${i}`}><button class={`accordion-button ${i===0?"":"collapsed"}`} type="button" data-bs-toggle="collapse" data-bs-target={`#c-${i}`}>{r.feature}</button></h2>
            <div id={`c-${i}`} class={`accordion-collapse collapse ${i===0?"show":""}`} data-bs-parent="#pricingAccordion"><div class="accordion-body">
              <div class="mb-2"><div class="nb-rowlabel">{basicName}</div><div>{r.basic}</div></div>
              <div><div class="nb-rowlabel">{premiumName}</div><div>{r.premium}</div></div>
            </div></div>
          </div>
        ))}
      </div>
    </div>
  </div>
</section>
