---
const { site } = Astro.props;
const p = site.pricing ?? {};
const rows = p.rows ?? [];
const basicName = p.plans?.[0]?.name ?? 'Basic Care Plan';
const premiumName = p.plans?.[1]?.name ?? 'Premium Care + Extended Warranty';

const renderValue = (v) => {
  const text = String(v ?? '');
  if (text.trim().startsWith('✓')) {
    return { check: true, rest: text.replace(/^\s*✓\s*/, '').trim() };
  }
  return { check: false, rest: text };
};
---
<section id="pricing" class="nb-anchor-offset nb-section" style="background:#f8fafc">
  <div class="container">
    <div class="text-center mb-4">
      <h2 class="section-title fw-bold">{p.title ?? 'Service Plan Comparison'}</h2>
      <p class="text-secondary">{p.subtitle ?? ''}</p>
    </div>

    <div class="row g-3 mb-3">
      <div class="col-lg-6"><div class="p-4 nb-card nb-pop h-100"><h3 class="h4 fw-bold mb-1">{basicName}</h3><div class="text-secondary">{p.plans?.[0]?.monthly ?? ''}</div><a class="btn nb-btn-primary btn-sm mt-3" href="#contact">Request more information</a></div></div>
      <div class="col-lg-6"><div class="p-4 nb-card nb-pop h-100"><h3 class="h4 fw-bold mb-1">{premiumName}</h3><div class="text-secondary">{p.plans?.[1]?.monthly ?? ''}</div><a class="btn nb-btn-primary btn-sm mt-3" href="#contact">Request more information</a></div></div>
    </div>

    <div class="row g-3">
      <div class="col-lg-6">
        <div class="nb-card p-0 overflow-hidden h-100">
          <div class="nb-plan-head">{basicName}</div>
          <div class="nb-plan-body">
            {rows.map((r) => { const val = renderValue(r.basic); return (
              <div class="nb-plan-row">
                <div class="nb-plan-feature">{r.feature}</div>
                <div class="nb-plan-value">{val.check && <span class="nb-check">✓</span>} {val.rest}</div>
              </div>
            );})}
          </div>
        </div>
      </div>
      <div class="col-lg-6">
        <div class="nb-card p-0 overflow-hidden h-100">
          <div class="nb-plan-head">{premiumName}</div>
          <div class="nb-plan-body">
            {rows.map((r) => { const val = renderValue(r.premium); return (
              <div class="nb-plan-row">
                <div class="nb-plan-feature">{r.feature}</div>
                <div class="nb-plan-value">{val.check && <span class="nb-check">✓</span>} {val.rest}</div>
              </div>
            );})}
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
