---
const { site } = Astro.props;
const c = site.contact ?? {};
---
<section id="contact" class="nb-anchor-offset nb-section">
  <div class="container">
    <div class="row g-4 align-items-start">
      <div class="col-lg-5">
        <h2 class="nb-section-title">{c.title}</h2>
        <p class="nb-section-subtitle mt-3">{c.lead}</p>
        <div class="nb-card mt-4">
          <div class="small text-secondary">{c.phoneLabel}</div>
          <a class="text-decoration-none fw-semibold" href={c.phoneHref}>{c.phoneText}</a>
          <div class="small text-secondary mt-3">{c.emailLabel}</div>
          <a class="text-decoration-none fw-semibold" href={c.emailHref}>{c.emailText}</a>
          <div class="mt-4"><a class="btn nb-btn-primary" href={site.bookings?.url} target="_blank" rel="noopener">Book a consult</a></div>
        </div>
      </div>
      <div class="col-lg-7">
        <div class="nb-card">
          <h3 class="h5 fw-bold mb-3">Send a message</h3>
          <form id="contactForm" class="row g-3">
            <div class="col-md-6"><label class="form-label">Name</label><input class="form-control" name="name" required /></div>
            <div class="col-md-6"><label class="form-label">Email</label><input class="form-control" name="email" type="email" required /></div>
            <div class="col-md-6"><label class="form-label">Phone</label><input class="form-control" name="phone" type="tel" /></div>
            <div class="col-md-6"><label class="form-label">Practice / Organization</label><input class="form-control" name="org" /></div>
            <div class="col-12"><label class="form-label">Message</label><textarea class="form-control" name="message" rows="6" required></textarea></div>
            <div class="col-12 d-flex flex-wrap gap-2 align-items-center">
              <button class="btn nb-btn-primary" type="submit">Send message</button>
              <a class="btn btn-outline-secondary rounded-pill" href={c.emailHref}>Email using my mail app</a>
              <div id="contactStatus" class="small text-secondary"></div>
            </div>
          </form>
          <script>
            const form=document.getElementById("contactForm");
            const statusEl=document.getElementById("contactStatus");
            form?.addEventListener("submit",(e)=>{
              e.preventDefault();
              const fd=new FormData(form);
              const name=(fd.get("name")||"").toString();
              const email=(fd.get("email")||"").toString();
              const phone=(fd.get("phone")||"").toString();
              const org=(fd.get("org")||"").toString();
              const msg=(fd.get("message")||"").toString();
              const subject=encodeURIComponent(`NexGen Binary website inquiry${org?" - "+org:""}`);
              const body=encodeURIComponent(`Name: ${name}\nEmail: ${email}\nPhone: ${phone}\nOrganization: ${org}\n\nMessage:\n${msg}`);
              statusEl.textContent="Opening your email appâ€¦";
              window.location.href=`mailto:info@nexgenbinary.com?subject=${subject}&body=${body}`;
              setTimeout(()=>{statusEl.textContent="If your email app did not open, use the Email button.";},1200);
            });
          </script>
        </div>
      </div>
    </div>
  </div>
</section>
